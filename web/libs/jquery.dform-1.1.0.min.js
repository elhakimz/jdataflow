/*! jquery.dform 2013-06-04 */
!function(a){var b={},c={},d=a.each,e=function(b){var c=function(d,e,f){"object"==typeof d?a.each(d,function(a,b){c(a,b,f)}):(void 0===f||f===!0)&&(b[d]||(b[d]=[]),b[d].push(e))};return c},f=a.isArray,g=function(b){return a.map(b,function(a,b){return b})},h=function(a,b){var c={};return d(b,function(b,d){a[d]&&(c[d]=a[d])}),c},i=function(b,c){var e={};return d(b,function(b,d){~a.inArray(b,c)||(e[b]=d)}),e},j=function(c,e,f){return a.dform.hasSubscription(c)&&this.each(function(){var g=a(this);d(b[c],function(a,b){b.call(g,e,f)})}),this},k=function(a){var b=a.type,c=this;return this.dform("run","[pre]",a,b),d(a,function(a,d){c.dform("run",a,d,b)}),this.dform("run","[post]",a,b),this};a.extend(a,{keyset:g,withKeys:h,withoutKeys:i,dform:{options:{prefix:"ui-dform-"},defaultType:function(b){return a("<"+b.type+">").dform("attr",b)},types:function(a){return a?c[a]:c},addType:e(c),subscribers:function(a){return a?b[a]:b},subscribe:e(b),hasSubscription:function(a){return b[a]?!0:!1},createElement:function(b){if(!b.type)throw"No element type given! Must always exist.";var e=b.type,f=null,g=a.withoutKeys(b,["type"]);return c[e]?d(c[e],function(a,b){f=b.call(f,g)}):f=a.dform.defaultType(b),a(f)},methods:{run:function(a,b,c){return"string"!=typeof a?k.call(this,a):j.call(this,a,b,c)},append:function(b,c){c&&a.dform.converters&&a.isFunction(a.dform.converters[c])&&(b=a.dform.converters[c](b));var d=a.dform.createElement(b);this.append(d),d.dform("run",b)},attr:function(c,d){var e=a.keyset(b);f(d)&&a.merge(e,d),this.attr(a.withoutKeys(c,e))},ajax:function(b,c,d){var e={error:d,url:b},f=this;"string"!=typeof b&&a.extend(e,b),e.success=function(a){var d=c||b.success;f.dform(a),d&&d.call(f,a)},a.ajax(e)},init:function(b,c){var d=b.type?b:a.extend({type:"form"},b);c&&a.dform.converters&&a.isFunction(a.dform.converters[c])&&(d=a.dform.converters[c](d)),this.is(d.type)?(this.dform("attr",d),this.dform("run",d)):this.dform("append",d)}}}}),a.fn.dform=function(b,c,d){var e=a(this);return a.dform.methods[b]?a.dform.methods[b].apply(e,Array.prototype.slice.call(arguments,1)):"string"==typeof b?a.dform.methods.ajax.call(e,{url:b,dataType:"json"},c,d):a.dform.methods.init.apply(e,arguments),this}}(jQuery),function(a){var b=a.each,c=function(b,c){return function(d){return a(b).dform("attr",d,c)}},d=function(c){var d=this;a.isPlainObject(c)?d.dform("append",c):a.isArray(c)?b(c,function(a,b){d.dform("append",b)}):d.html(c)};a.dform.addType({container:c("<div>"),text:c('<input type="text" />'),password:c('<input type="password" />'),submit:c('<input type="submit" />'),reset:c('<input type="reset" />'),hidden:c('<input type="hidden" />'),radio:c('<input type="radio" />'),checkbox:c('<input type="checkbox" />'),file:c('<input type="file" />'),number:c('<input type="number" />'),url:c('<input type="url" />'),tel:c('<input type="tel" />'),email:c('<input type="email" />'),checkboxes:c("<div>",["name"]),radiobuttons:c("<div>",["name"])}),a.dform.subscribe({"class":function(a){this.addClass(a)},html:d,elements:d,value:function(a){this.val(a)},css:function(a){this.css(a)},options:function(c,d){var e=this;"select"!==d&&"optgroup"!==d||"string"==typeof c?("checkboxes"===d||"radiobuttons"===d)&&b(c,function(b,c){var f="radiobuttons"===d?{type:"radio"}:{type:"checkbox"};"string"==typeof c?f.caption=c:a.extend(f,c),f.value=b,e.dform("append",f)}):b(c,function(b,c){var d={type:"option",value:b};"string"==typeof c&&(d.html=c),"object"==typeof c&&(d=a.extend(d,c)),e.dform("append",d)})},caption:function(b,c){var d={};if("string"==typeof b?d.html=b:a.extend(d,b),"fieldset"==c)d.type="legend",this.dform("append",d);else{d.type="label",this.attr("id")&&(d["for"]=this.attr("id"));var e=a(a.dform.createElement(d));"checkbox"===c||"radio"===c?this.parent().append(a(e)):e.insertBefore(this),e.dform("run",d)}},type:function(b,c){a.dform.options.prefix&&this.addClass(a.dform.options.prefix+c)},url:function(a){this.dform("ajax",a)},"[post]":function(b,c){if("checkboxes"===c||"radiobuttons"===c){var d="checkboxes"===c?"checkbox":"radio";this.children("[type="+d+"]").each(function(){a(this).attr("name",b.name)})}}})}(jQuery),function(a){var b=function(b,c){return a.withKeys(c,a.keyset(a.ui[b].prototype.options))},c=function(a,b){for(var c=b,d=0;d<a.length;d++)if(c=c[a[d]],!c)return null;return c};a.dform.addType("progressbar",function(c){return a("<div>").dform("attr",c).progressbar(b("progressbar",c))},a.isFunction(a.fn.progressbar)),a.dform.addType("slider",function(c){return a("<div>").dform("attr",c).slider(b("slider",c))},a.isFunction(a.fn.slider)),a.dform.addType("accordion",function(b){return a("<div>").dform("attr",b)},a.isFunction(a.fn.accordion)),a.dform.addType("tabs",function(b){return a("<div>").dform("attr",b)},a.isFunction(a.fn.tabs)),a.dform.subscribe("entries",function(b,c){if("accordion"==c){var d=this;a.each(b,function(b,c){var e=a.extend({type:"div"},c);if(a(d).dform("append",e),c.caption){var f=a(d).children("div:last").prev();f.replaceWith('<h3><a href="#">'+f.html()+"</a></h3>")}})}},a.isFunction(a.fn.accordion)),a.dform.subscribe("entries",function(b,c){if("tabs"==c){var d=this;this.append("<ul>");var e=a(d).children("ul:first");a.each(b,function(b,c){var f=c.id?c.id:b;a.extend(c,{type:"container",id:f}),a(d).dform("append",c);var g=a(d).children("div:last").prev();a(g).wrapInner(a("<a>").attr("href","#"+f)),a(e).append(a("<li>").wrapInner(g))})}},a.isFunction(a.fn.tabs)),a.dform.subscribe("dialog",function(a){this.dialog(a)},a.isFunction(a.fn.dialog)),a.dform.subscribe("resizable",function(a){this.resizable(a)},a.isFunction(a.fn.resizable)),a.dform.subscribe("datepicker",function(a,b){"text"==b&&this.datepicker(a)},a.isFunction(a.fn.datepicker)),a.dform.subscribe("autocomplete",function(a,b){"text"==b&&this.autocomplete(a)},a.isFunction(a.fn.autocomplete)),a.dform.subscribe("[post]",function(c,d){this.parents("form").hasClass("ui-widget")&&("button"!==d&&"submit"!==d||!a.isFunction(a.fn.button)||this.button(),~a.inArray(d,["text","textarea","password","fieldset"])&&this.addClass("ui-widget-content ui-corner-all")),("accordion"===d||"tabs"===d)&&this[d](b(d,c))}),a.dform.subscribe("[pre]",function(b,c){if("form"==c){var d={};this.hasClass("ui-widget")&&(d={highlight:function(b){a(b).addClass("ui-state-highlight")},unhighlight:function(b){a(b).removeClass("ui-state-highlight")}}),"object"==typeof b.validate&&a.extend(d,b.validate),this.validate(d)}},a.isFunction(a.fn.validate)),a.dform.subscribe("validate",function(a,b){"form"!=b&&this.rules("add",a)},a.isFunction(a.fn.validate)),a.dform.subscribe("ajax",function(a,b){"form"===b&&this.ajaxForm(a)},a.isFunction(a.fn.ajaxForm)),a.dform.subscribe("html",function(b){if("string"==typeof b){var d=b.split("."),e=Globalize.localize(d.shift());(e=c(d,e))&&a(this).html(e)}},"undefined"!=typeof Globalize&&a.isFunction(Globalize.localize)),a.dform.subscribe("options",function(b,d){if("select"===d&&"string"==typeof b){a(this).html("");var e=b.split("."),f=Globalize.localize(e.shift());(f=c(e,f))&&a(this).dform("run","options",f,d)}},"undefined"!=typeof Globalize&&a.isFunction(Globalize.localize))}(jQuery);